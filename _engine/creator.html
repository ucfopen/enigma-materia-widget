<!DOCTYPE html>
<!-- INJECTS IE CLASSES ONTO HTML TAG -->
<!--[if IE 8 ]>    <html class="IE8"> <![endif]-->
<!--[if IE 9 ]>    <html class="IE9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class=""> <!--<![endif]-->
	<head>
		<title>Enigma Widget Creator</title>
		<meta charset="utf-8" />

		<!-- STYLESHEETS -->
		<link rel="stylesheet" type="text/css" href="creator.css">
		<link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700' rel='stylesheet' type='text/css'>
		<link href='assets/jquery-ui-1.10.4.custom.css' rel='stylesheet' type='text/css'>

		<!-- REQUIRED MATERIA JAVASCRIPT -->
		<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
		<script type="text/javascript" src="/js/materia.creatorcore.js"></script>

		<!-- YOUR PREREQUISITES -->
		<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.0rc3/angular.min.js"></script>
		<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.0rc3/angular-animate.min.js"></script>
		<script type="text/javascript" src="assets/jquery-ui-1.10.4.custom.js"></script>

		<!-- MAIN CREATOR SCRIPT -->
		<script src="creator.js"></script>
	</head>
	<body ng-cloak ng-controller='enigmaCreatorCtrl'>
		<div id='modal'></div>
		<div id='header'>
			<div class='logo'></div>
			<h1 id='title' ng-bind='title'></h1>
			<div class='link' ng-click='changeTitle()'>Edit...</div>
			<div class='center'>{{numQuestions()}} Questions</div>
			<div class='right'>
				Randomize Answer Order
				<input type='checkbox' id='randomize' ng-model='qset.options.randomize'/>
				<label for='randomize' class='checktoggle'></label>
			</div>
		</div>
		<div class='importedbackground {{ imported.length ? "show" : "" }}'></div>
		<div id='board'>
			<div class='imported_pane {{ imported.length ? "show" : "" }}'>
				<div class='arrow_box' ng-show='!shownImportTutorial'>
					Drag &amp; drop these over empty questions to add them to your game board
				</div>
				<div class='background'></div>
				<div class='imported'>
					<input type='button' ng-click='imported = []' value='Done Importing'>
					<b>Imported questions</b><br>
					<div class='overflower'>
						<div class='importable' ng-repeat='question in imported' data-index='{{$index}}'>
							<strong>{{ question.questions[0].text }}</strong> {{ question.answers[0].text }}
							<a href='javascript:;' ng-click='imported.splice($index,1)'>x</a>
						</div>
					</div>
				</div>
			</div>
			<div class='categories'>
				<div class='category' ng-repeat='category in qset.items'>
					<div class='label' style='opacity:{{ categoryOpacity(category,$index) }}'>
						<textarea ng-model='category.name' id='category_{{$index}}' ng-disabled='!categoryEnabled(category,$index)' ng-focus='editCategory(category)' ng-blur='stopCategory(category)' ng-keydown='updateCategory()'></textarea>
					</div>
					<button ng-show='categoryShowAdd(category,$index)' class='add'></button>
					<div ng-show='categoryShowAdd(category,$index)' class='newcat' ng-click='newCategory({{$index}}, category)'>New Category</div>
					<div class='questionholder' ng-repeat='question in category.items' ng-click='editQuestion(category,question,{{$index}})'>
						<div class='question {{ question.questions[0].text ? "show" : "" }}' data-category='{{category.index}}' data-question='{{$index}}'>
							<div class='hover'><strong>{{ question.questions[0].text }}</strong> {{ question.answers[0].text }}</div>
							<div class='number'>{{ $index+1 }}</div>
						</div>
						<button ng-show='questionShowAdd(category, question, $index)' class='add'></button>
					</div>
				</div>
				<div id='question_editor' ng-style='{ top: ((curCategory.index+1) * 122) + "px" }' class='q{{curQuestion.index+1}} {{curQuestion ? "show" : ""}}'>
					<div class='title'>Question {{curQuestion.index+1}} in "{{curCategory.name}}"</div>

					<textarea ng-model='curQuestion.questions[0].text' placeholder='Enter your question here' id='question_text' autofocus></textarea>

					<div class='questions'>
						<div ng-repeat='answer in curQuestion.answers'>
							<textarea ng-model='answer.text' placeholder='Enter an answer choice'></textarea>
							<textarea ng-model='answer.options.feedback' placeholder='Enter optional feedback'></textarea>

							<div class='controls'>
								<div ng-show='!answer.options.custom'>
									<input type='checkbox' id='qtoggle{{$index}}' ng-model='answer.options.correct'/>
									<label for='qtoggle{{$index}}' class='checktoggle correctness'><span></span></label>
									<a href='javascript:;' ng-click='answer.options.custom = true'>Set percentage</a>
								</div>
								<div class='text' ng-show='answer.options.custom'>
									<input type='text' ng-model='answer.value' ng-change='numbersOnly(answer)' ng-blur=''>%
								</div>
							</div>
							<button class='delete' ng-click='deleteAnswer($index)'></button>
						</div>
						<a href='javascript:;' ng-click='addAnswer()'>+ Add another answer choice</a>
					</div>
					<div class='controls'>
						<a href='javascript:;' ng-click='deleteQuestion(curQuestion.index)'>Delete</a>
						<input type='button' value='Close' ng-click='editComplete()'>
					</div>
				</div>
				<div class='arrow_box' id='first_cat' ng-show='step == 1'>Click here to create your first category</div>
				<div class='arrow_box' id='second_cat' ng-show='step == 2'>Now name this category</div>
				<div class='arrow_box' id='third_cat' ng-show='step == 3'>Click here to add your first question</div>
			</div>
		</div>
		<div id='backgroundcover' ng-click='hideCover()'></div>
		<div class='box intro'>
			<img src='assets/creator_example.png'>
			<h1>Enigma</h1>
			<p>Create a gameboard of multiple choice questions</p>
			<p>Questions are organized by categories.</p>
			<p>Each question is worth the same amount.</p>
			<hr>
			<b>Start by giving your Enigma widget a title</b><br>
			<input type='text' placeholder='My enigma widget' autofocus='1'>
			<input type='button' value='Get Started'>
		</div>
		<div class='box title'>
			<b>Give your Enigma widget a title</b><br>
			<input type='text' placeholder='My enigma widget' ng-model='title' id='till'>
			<input type='button' value='Done'>
		</div>

		<!-- INITIALIZE -->
		<script type="text/javascript">
			angular.bootstrap(document, ['enigmaCreator']);
			Materia.CreatorCore.start(Enigma.Creator);
		</script>

	</body>
</html>
